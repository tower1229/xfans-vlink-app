---
description: 电子商务系统安全最佳实践，确保系统和用户数据的安全性。
globs:  app/**/*
alwaysApply: false
---
---
description: 电子商务系统安全最佳实践，确保系统和用户数据的安全性。
globs: app/**/*
alwaysApply: false
---

# 电子商务系统安全最佳实践

## 身份验证与授权
- 实现强密码策略，包括复杂度要求和定期更改
- 使用多因素身份验证，特别是对管理员和高价值账户
- 实现基于角色的访问控制 (RBAC)，限制用户权限
- 使用安全的会话管理，包括会话超时和安全 Cookie

## 数据保护
- 加密传输中的数据，使用 TLS 1.3 或更高版本
- 加密存储的敏感数据，如密码和支付信息
- 实现数据脱敏，保护个人身份信息
- 遵循最小权限原则，限制数据访问

## 输入验证与输出编码
- 验证所有用户输入，防止注入攻击
- 实现输出编码，防止 XSS 攻击
- 使用参数化查询，防止 SQL 注入
- 验证文件上传，限制文件类型和大小

## API 安全
- 实现 API 速率限制，防止暴力攻击
- 使用安全的 API 密钥管理
- 实现 CORS 策略，限制跨域请求
- 使用 CSRF 令牌，防止跨站请求伪造

## 支付安全
- 遵循 PCI DSS 标准，保护支付卡数据
- 使用安全的支付网关，避免直接处理支付卡数据
- 实现欺诈检测机制，识别可疑交易
- 提供安全的退款和争议解决流程

## 基础设施安全
- 定期更新和补丁系统，修复已知漏洞
- 实现网络分段，隔离敏感系统
- 使用 Web 应用防火墙 (WAF)，防止常见攻击
- 实现入侵检测和防御系统

## 安全监控与响应
- 实现全面的日志记录，记录安全相关事件
- 定期审查安全日志，识别可疑活动
- 制定安全事件响应计划，包括数据泄露处理
- 进行定期安全评估和渗透测试

## 合规性
- 遵循数据保护法规，如 GDPR 和 CCPA
- 实现隐私政策和用户同意机制
- 保留必要的审计记录，满足合规要求
- 定期进行合规性评估和审计